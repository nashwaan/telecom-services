/*
 telecom-services 2016-01-17 
*/
!function(a){"use strict";a.module("TheApp",["ngRoute","ngMaterial","ngMdIcons","gridster","dndLists","agGrid","etsDraggableDirective","etsFilters"]).config(["$routeProvider","$locationProvider","$mdThemingProvider","$mdIconProvider",function(a,b,c,d){function e(a,b){var c=parseInt(a.slice(1),16),d=0>b?0:255,e=0>b?-1*b:b,f=c>>16,g=c>>8&255,h=255&c;return"#"+(16777216+65536*(Math.round((d-f)*e)+f)+256*(Math.round((d-g)*e)+g)+(Math.round((d-h)*e)+h)).toString(16).slice(1)}a.when("/assemble",{templateUrl:"assemble-part/assemble.html"}).when("/manufacture",{templateUrl:"manufacture-part/manufacture.html"}).otherwise({redirectTo:"/assemble"});var f="#84b478",g="#fce2c7";c.definePalette("etisalatGreenPalette",{50:e(f,.8),100:e(f,.6),200:e(f,.4),300:e(f,.2),400:e(f,0),500:e(f,-.2),600:e(f,-.4),700:e(f,-.55),800:e(f,-.7),900:e(f,-.85),A100:e(f,.4),A200:e(f,0),A400:e(f,-.4),A700:e(f,-.7),contrastDefaultColor:"light",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:["500","600","700","800","900","A400","A700"]}),c.definePalette("etisalatGreyPalette",{50:e(g,.8),100:e(g,.6),200:e(g,.4),300:e(g,.2),400:e(g,0),500:e(g,-.2),600:e(g,-.4),700:e(g,-.55),800:e(g,-.7),900:e(g,-.85),A100:e(g,.4),A200:e(g,0),A400:e(g,-.4),A700:e(g,-.7),contrastDefaultColor:"dark",contrastDarkColors:["50","100","200","300","400","A100"],contrastLightColors:["500","600","700","800","900","A400","A700"]}),c.theme("default").primaryPalette("etisalatGreenPalette").accentPalette("etisalatGreyPalette"),c.theme("etisalat-dark","default").primaryPalette("orange").dark(),d.defaultViewBoxSize(40),d.iconSet("gui","icons/gui-icons.svg").icon("logo","icons/logo.svg").icon("menu","icons/menu.svg").icon("apps","icons/apps.svg").icon("new","icons/new.svg").icon("add","icons/add.svg").icon("undo","icons/undo.svg").icon("redo","icons/redo.svg").icon("upload","icons/upload.svg").icon("download","icons/download.svg").icon("save","icons/save.svg").icon("cut","icons/cut.svg").icon("copy","icons/copy.svg").icon("paste","icons/paste.svg").icon("delete","icons/delete.svg").icon("select","icons/select.svg").icon("rect","icons/rect.svg").icon("3dots","icons/3dots.svg").icon("up","icons/up.svg").icon("down","icons/down.svg").icon("share","icons/share.svg").icon("box","icons/box.svg").icon("stand","icons/stand.svg").icon("brick","icons/brick.svg").icon("lines","icons/lines.svg").icon("Master:Account","icons/property/Account.svg").icon("Master:Add-on","icons/property/Add-on.svg").icon("Master:BasePlan","icons/property/BasePlan.svg").icon("Master:Bundle","icons/property/Bundle.svg").icon("Master:CallFreebees","icons/property/CallFreebees.svg").icon("Master:CallTariff","icons/property/CallTariff.svg").icon("Master:ChangeArrow","icons/property/ChangeArrow.svg").icon("Master:ChangeFlavor","icons/property/ChangeFlavor.svg").icon("Master:Charge","icons/property/Charge.svg").icon("Master:Constraint","icons/property/Constraint.svg").icon("Master:Contract","icons/property/Contract.svg").icon("Master:Credit","icons/property/Credit.svg").icon("Master:DataFreebees","icons/property/DataFreebees.svg").icon("Master:DataTariff","icons/property/DataTariff.svg").icon("Master:Device","icons/property/Device.svg").icon("Master:DownArrow","icons/property/DownArrow.svg").icon("Master:EndArrow","icons/property/EndArrow.svg").icon("Master:File","icons/property/File.svg").icon("Master:Info","icons/property/Info.svg").icon("Master:Inquiry","icons/property/Inquiry.svg").icon("Master:LeftArrow","icons/property/LeftArrow.svg").icon("Master:MessageFreebees","icons/property/MessageFreebees.svg").icon("Master:MessageTariff","icons/property/MessageTariff.svg").icon("Master:Migrate","icons/property/Migrate.svg").icon("Master:Migration","icons/property/Migration.svg").icon("Master:Notification","icons/property/Notification.svg").icon("Master:Project","icons/property/Project.svg").icon("Master:Provisioning","icons/property/Provisioning.svg").icon("Master:Report","icons/property/Report.svg").icon("Master:Rewards","icons/property/Rewards.svg").icon("Master:RightArrow","icons/property/RightArrow.svg").icon("Master:SimCard","icons/property/SimCard.svg").icon("Master:Square","icons/property/Square.svg").icon("Master:SquareAim","icons/property/SquareAim.svg").icon("Master:SquareDashed","icons/property/SquareDashed.svg").icon("Master:Stakeholder","icons/property/Stakeholder.svg").icon("Master:Subscribe","icons/property/Subscribe.svg").icon("Master:Support","icons/property/Support.svg").icon("Master:Unsubscribe","icons/property/Unsubscribe.svg").icon("Master:UpArrow","icons/property/UpArrow.svg").icon("Master:Xor","icons/property/Xor.svg")}]).run(function(a){a.debug("TheApp with its dependecies is loaded and running...")}),a.module("TheApp").controller("selectController",["$rootScope",function(a){a.selected={item:null,type:""}}])}(window.angular),function(a){"use strict";a.module("etsDraggableDirective",[]).directive("etsDraggable",["$document",function(a){return{link:function(b,c,d){function e(a){j=a.pageY-h,i=a.pageX-g,c.css({top:j+"px",left:i+"px"})}function f(){a.off("mousemove",e),a.off("mouseup",f)}var g=0,h=0,i=0,j=0;c.on("mousedown",function(b){b.preventDefault(),g=b.pageX-i,h=b.pageY-j,a.on("mousemove",e),a.on("mouseup",f)}),c.css({position:"relative",border:"1px solid red",backgroundColor:"lightgrey",cursor:"pointer"})}}}])}(window.angular),function(a){"use strict";a.module("etsFilters",[]).filter("icon_file",function(){return function(a,b){a=a||"";var c=a.replace(/\s+/g,"");return b&&(c=c.toUpperCase()),"icon"+c}}).filter("icon_provider",function(){return function(a){a=a||"";var b=a.replace(/\s+/g,"");return"Master:"+b}})}(window.angular),function(a){"use strict";a.module("TheApp").factory("schemasService",[function(){return{masterFresh:function(){return{name:"",description:"",icon:"",type:"",Attributes:[],groupName:"",collectionName:""}},masterSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Master",description:"Edit master properties.",type:"object",additionalProperties:!0,properties:{name:{title:"Master Name",description:"Specify name for this master.",type:"string","default":""},description:{title:"Master Description",description:"Specify description for this master.",type:"string","default":""},icon:{title:"Icon",description:"Specify icon for the master.",type:"string","enum":["Device","Charge","Call","Message","Data"],"default":""},type:{title:"Type",description:"Specify type of the master.",type:"string","enum":["Standard","Modifier"],"default":""},groupName:{title:"Group Name",description:"Specify group name for this master.",type:"string","default":""},collectionName:{title:"Collection Name",description:"Specify collection name for this master.",type:"string","default":""}}}},attributeFresh:function(){return{schema:{title:"No Title",description:"No Description",type:"string","enum":[],required:!1,minLength:0,maxLength:100,minimum:0,exclusiveMinimum:!1,maximum:0,exclusiveMaximum:!1,multipleOf:1,"default":""}}},attributeSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Attribute",description:"Edit attribute properties.",type:"object",additionalProperties:!0,properties:{title:{title:"Name of attribute",description:"For 'title' of attribute schema.",type:"string","default":""},description:{title:"Description of attribute",description:"For 'description' of attribute schema.",type:"string","default":""},type:{title:"Type of attribute",description:"For 'type' of attribute schema.",type:"string","enum":["string","number","boolean","choice","options"],"default":""},required:{title:"Required attribute?",description:"For 'type' of attribute schema.",type:"boolean","default":""},"enum":{title:"Enum of attribute",description:"For 'enum' of attribute schema.",type:"array","default":""},minLength:{title:"Minimum Length of attribute",description:"For 'minLength' of attribute schema.",type:"number","default":""},maxLength:{title:"Maximum Length of attribute",description:"For 'maxLength' of attribute schema.",type:"number","default":""},minimum:{title:"Minimum of attribute",description:"For 'minimum' of attribute schema.",type:"number","default":""},exclusiveMinimum:{title:"Exclusive Minimum?",description:"For 'exclusiveMinimum' of attribute schema.",type:"boolean","default":""},maximum:{title:"Maximum of attribute",description:"For 'maximum' of attribute schema.",type:"number","default":""},exclusiveMaximum:{title:"Exclusive Maximum?",description:"For 'exclusiveMaximum' of attribute schema.",type:"boolean","default":""},multipleOf:{title:"Step of attribute",description:"For 'multipleOf' of attribute schema.",type:"number",minimum:0,exclusiveMinimum:!0,maximum:1e3,exclusiveMaximum:!1,"default":""},"default":{title:"Default of attribute",description:"For 'default' of attribute schema.",type:"string","default":""}}}},planFresh:function(){return{name:"",description:"",Bands:[]}},planSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Plan",description:"Edit plan properties.",type:"object",additionalProperties:!0,properties:{name:{title:"Plan Name",description:"Specify name for this plan.",type:"string","default":""},description:{title:"Plan Description",description:"Specify description for this plan.",type:"string","default":""}}}},bandFresh:function(){return{name:"",description:"",Flavors:[]}},bandSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Band",description:"Edit band properties.",type:"object",additionalProperties:!0,properties:{name:{title:"Band Name",description:"Specify name for this band.",type:"string","default":""},description:{title:"Band Description",description:"Specify description for this band.",type:"string","default":""}}}},flavorFresh:function(){return{name:"",description:"",Features:[]}},flavorSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Flavor",description:"Edit flavor properties.",type:"object",additionalProperties:!0,properties:{name:{title:"Flavor Name",description:"Specify name for this flavor.",type:"string","default":""},description:{title:"Flavor Description",description:"Specify description for this flavor.",type:"string","default":""}}}},featureFresh:function(){return{name:"",description:"",Attributes:[]}},featureSchema:function(){return{$schema:"http://json-schema.org/draft-04/schema#",id:"http://www.etisalat.ae",title:"Feature",description:"Edit feature properties.",type:"object",additionalProperties:!0,properties:{name:{title:"Feature Name",description:"Specify name for this feature.",type:"string","default":""},description:{title:"Feature Description",description:"Specify description for this feature.",type:"string","default":""}}}}}}])}(window.angular),function(a){"use strict";a.module("TheApp").controller("actionsController",["$scope","$mdSidenav","$mdBottomSheet","$q",function(a,b,c,d){this.toggleSidenav=function(a){var e=c.hide()||d.when(!0);e.then(function(){b(a).toggle()})},a.$on("$locationChangeStart",function(b,c,d){a.page=c.split("/").splice(-1),a.styleUrl="demo/"+a.page+"/style.css"})}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("assembleService",["$http","$mdBottomSheet",function(a,b){var c=null;return{setPlan:function(a){c=a},getPlan:function(){return c},loadPlan:function(b){a.get(b).success(function(a){c=a,window.console.log("Plan data was loaded successfully.")})}}}]),a.module("TheApp").controller("assembleController",["$scope","$timeout","assembleService","schemasService","propertiesService","mastersService",function(b,c,d,e,f,g){var h=this;h.planActive=null,h.bandActive=null,h.flavorActive=null,h.featureActive=null,h.attributeActive=null,h.planStored=null,h.bandStored=null,h.flavorStored=null,h.featureStored=null,h.attributeStored=null,h.copy=function(b){return a.copy(b)},h.newPlan=function(){var a=e.planFresh();a.name="New Plan",a.description="Description for the new plan",d.setPlan(a),h.editPlan(a)},h.getPlan=function(){return d.getPlan()},h.editPlan=function(a){f.manage(e.planSchema(),a,"Bands")},h.activatePlan=function(a){h.planActive=a,h.editPlan(a)},h.loadPlan=function(){d.loadPlan("data/plan-A.json")},h.savePlan=function(a){return!0},h.addBand=function(a){a||(h.newPlan(),a=h.getPlan());var b=e.bandFresh();return b.name="New Band",b.description="Description for the new band",a.Bands.push(b),h.editBand(b),b},h.editBand=function(a){f.manage(e.bandSchema(),a,"Flavors")},h.activateBand=function(a){h.bandActive=a,h.editBand(a)},h.addFlavor=function(a){a||(a=h.addBand());var b=e.flavorFresh();return b.name="New Flavor",b.description="Description for the new flavor",a.Flavors.push(b),h.editFlavor(b),b},h.editFlavor=function(a){f.manage(e.flavorSchema(),a,"Features")},h.activateFlavor=function(a){h.flavorActive=a,h.editFlavor(a)},h.editFeature=function(a){var b=g.getMasterFromPath(a.masterPath);f.manage(b.Attributes,a,"Attributes")},h.activateFeature=function(a){h.featureActive=a,h.editFeature(a)},h.getMasterName=function(a){return a.masterPath.split(">")[2]},h.dropIntoFlavor=function(a,b,c,d,e,f){var g,h;if("feature"===e)g=c;else{g={};for(h in c.Attributes.properties)c.Attributes.properties.hasOwnProperty(h)&&(g[h]=null);g.masterPath=c.groupName+">"+c.collectionName+">"+c.name}return g}}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("manufactureService",["mastersService",function(b){var c=null;return{setMasterEdit:function(b){c=a.copy(b)},getMasterEdit:function(){return a.equals(c,b.getSelected())||this.setMasterEdit(b.getSelected()),c},isMasterDirty:function(){return a.equals(b.getSelected(),c)}}}]),a.module("TheApp").controller("manufactureController",["manufactureService","schemasService","propertiesService",function(a,b,c){this.getEditMaster=function(){return a.getMasterEdit()},this.selectMaster=function(){this.editMaster(a.getMasterEdit())},this.newMaster=function(){a.setMasterEdit(b.masterFresh()),this.editMaster(a.getMasterEdit())},this.editMaster=function(a){c.manage(b.masterSchema(),a,"Attributes")},this.addAttribute=function(){var c=b.attributeFresh();a.getMasterEdit().Attributes.properties.push(c),this.editAttribute(c)},this.editAttribute=function(a){c.manage(b.attributeSchema(),a,"value")},this.isMasterDirty=function(){return a.isMasterDirty()},this.isEditingMaster=function(){return!0}}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("mastersService",["$http",function(b){var c=null,d=null,e=function(a,b){var c,d=null;for(c=0;c<a.Groups.length;c+=1)a.Groups[c].name===b&&(d=a[c]);return d},f=function(a,b){var c,d=null;for(c=0;c<a.Collections.length;c+=1)a.Collections[c].name===b&&(d=a.Collections[c]);return d},g=function(){var a,b,d,e;for(a=0;a<c.Groups.length;a+=1)for(b=0;b<c.Groups[a].Collections.length;b+=1)for(d=0;d<c.Groups[a].Collections[b].Masters.length;d+=1)e=c.Groups[a].Collections[b].Masters[d],e.groupName=c.Groups[a].name,e.collectionName=c.Groups[a].Collections[b].name},h=function(a){var b,d,e,f=a.split(">");for(b=0;b<c.Groups.length;b+=1)if(c.Groups[b].name===f[0])for(d=0;d<c.Groups[b].Collections.length;d+=1)if(c.Groups[b].Collections[d].name===f[1]){for(e=0;e<c.Groups[b].Collections[d].Masters.length;e+=1)if(c.Groups[b].Collections[d].Masters[e].name===f[2])return c.Groups[b].Collections[d].Masters[e];return null}},i=function(a){b.get(a).success(function(a){c=a,g(),window.console.log("Masters data was retrieved successfully.")})};return i("data/masters.json"),{select:function(b,c,e){d=a.copy(e),d.groupName=b,d.collectionName=c,d.reference=e},getSelected:function(){return d},add:function(a,b){var d,g,h;b&&(h=e(c,b.groupName).findCollection(d.Collections,b.collectionName),h.splice(h.indexOf(b),1)),a.groupName||(a.groupName="General"),d=e(c,a.groupName),d||(c.push({name:a.groupName}),d=c.Groups[c.Groups.length-1]),a.collectionName||(a.collectionName="General"),g=f(d.Collections,a.collectionName),g||(d.Collections.push({name:a.collectionName}),g=c.Collections[c.Collections.length-1]),g.Masters.push(a)},getMasterFromPath:function(a){return h(a)},get:function(){return c},check:function(){window.alert(JSON.stringify(c))}}}]),a.module("TheApp").controller("mastersController",["mastersService","propertiesService","navigationService",function(a,b,c){var d=this;d.isDocked=function(a){return c.isSidenavLocked(a)},d.getGroups=function(){return a.get().Groups},d.selectMaster=function(c,d,e){a.select(c,d,e),b.manage(e.Attributes)}}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("navigationService",["manufactureService","assembleService","$location",function(a,b,c){var d={plans:!1,masters:!0,properties:!0};return{getTitle:function(){var d;switch(c.path()){case"/manufacture":return d=a.getMasterEdit(),d?d.name:"Manufacture Mode";case"/assemble":return d=b.getPlan(),d?d.name:"Design Mode";default:return"Telecom Designer"}},toggleSidenavLock:function(a){d[a]=!d[a]},isSidenavLocked:function(a){return d[a]}}}]),a.module("TheApp").controller("navigationController",["navigationService","$scope","$mdSidenav","$mdBottomSheet","$q","$mdMedia","$location",function(a,b,c,d,e,f,g){var h=this;(new Date).getFullYear();h.check=function(){window.alert(h.getTitle())},h.getTitle=function(){return a.getTitle()},h.toggleSidenav=function(b){if(f("gt-sm"))a.toggleSidenavLock(b);else{var g=d.hide()||e.when(!0);g.then(function(){c(b).toggle()})}},h.isOpenSidenav=function(a){return c(a).isOpen()},b.$on("$locationChangeStart",function(a,c,d){b.page=c.split("/").splice(-1),b.styleUrl="demo/"+b.page+"/style.css"}),h.changeMode=function(){g.path("/assemble"===g.path()?"manufacture":"assemble")}}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("plansService",["$http",function(a){var b=null;return{get:function(){return b},load:function(c,d){a.get(c).success(function(a){b=a,window.console.log("Masters data was retrieved successfully."),d.api.setRowData(b)})}}}]),a.module("TheApp").controller("plansController",["$scope","$http","plansService","navigationService",function(a,b,c,d){var e=this;e.isDocked=function(a){return d.isSidenavLocked(a)}}]),a.module("TheApp").controller("plansController2",["$scope","$http","plansService","navigationService",function(a,b,c,d){function e(a){var b,c;return b=a.node.group?0===a.node.level?"disk":"folder":"file",c="icons/"+b+".png",'<img src="'+c+'" style="padding-left:4px" /> '+a.data.name}function f(b){for(var c=b.nod,d=c.data.name;c.parent;)c=c.parent,d=c.data.name+"\\"+d;a.selectedFile=d}var g=this,h=[{headerName:"Name",field:"name",width:250,cellRenderer:{renderer:"group",innerRenderer:e}},{headerName:"Size",field:"size",width:70,cellStyle:{"text-align":"right"}},{headerName:"Type",field:"type",width:150},{headerName:"Date Modified",field:"dateModified",width:150}];a.selectedFile="Select a file below...",g.gridOptions={columnDefs:h,rowSelection:"multiple",rowsAlreadyGrouped:!0,enableColResize:!0,enableSorting:!0,rowHeight:20,icons:{groupExpanded:"<i>-</i>",groupContracted:"<i>+</i>"},onRowClicked:f},c.load("data/files.json",g.gridOptions)}])}(window.angular),function(a){"use strict";a.module("TheApp").factory("propertiesService",function(){var b=null,c=null,d=null,e="",f=function(){if(c=a.copy(d)){var b,f=e.split(";");for(b=0;b<f.length;b+=1)c.hasOwnProperty(f[b])&&delete c[f[b]]}};return{manage:function(g,h,i){if(b=g,d=h,e=i,f(),void 0!==h){var j;for(j in c)c.hasOwnProperty(j)&&b.properties.hasOwnProperty(j)&&(b.properties[j].value=a.copy(h[j]))}},get:function(){return b},update:function(){var e;for(e in c)c.hasOwnProperty(e)&&b.properties.hasOwnProperty(e)&&(d[e]=a.copy(b.properties[e].value));f()},revert:function(){var a;for(a in c)c.hasOwnProperty(a)&&b.properties.hasOwnProperty(a)&&(b.properties[a].value=c[a])},isDirty:function(){if(void 0===d)return!1;var e;for(e in c)if(c.hasOwnProperty(e)&&b.properties.hasOwnProperty(e)&&!a.equals(b.properties[e].value,c[e]))return!0;return!1},check:function(){window.alert(JSON.stringify(d))}}}),a.module("TheApp").controller("propertiesController",["navigationService","propertiesService","mastersService",function(a,b,c){var d=this;d.isDocked=function(b){return a.isSidenavLocked(b)},d.properties=b,d.updateValues=function(a){b.update()},d.isPropertiesDirty=function(){return b.isDirty()},d.revertValues=function(a){b.revert()},d.check=function(){b.check()},d.getProperties=function(){return b.get()}}])}(window.angular),function(a){"use strict";a.module("TheApp").controller("writerController",["assembleService",function(a){this.check=function(){window.alert("CHECK:\n"+JSON.stringify(a.getPlan().name))},this.getPlan=function(){return a.getPlan()},this.getMasterName=function(a){return a.masterPath.split(">")[2]},this.getTotalAttributes=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&(c+=1);return c}}])}(window.angular);